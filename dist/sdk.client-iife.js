var HarnessFFSDK=(()=>{var et=Object.create,we=Object.defineProperty,tt=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty,rt=Object.getOwnPropertyNames,at=Object.getOwnPropertyDescriptor;var re=Object.assign,it=n=>we(n,"__esModule",{value:!0});var ot=(n,a)=>()=>(a||(a={exports:{}},n(a.exports,a)),a.exports),st=(n,a)=>{for(var l in a)we(n,l,{get:a[l],enumerable:!0})},dt=(n,a,l)=>{if(a&&typeof a=="object"||typeof a=="function")for(let s of rt(a))!nt.call(n,s)&&s!=="default"&&we(n,s,{get:()=>a[s],enumerable:!(l=at(a,s))||l.enumerable});return n},ft=n=>dt(it(we(n!=null?et(tt(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var be=(n,a,l)=>new Promise((s,T)=>{var b=M=>{try{C(l.next(M))}catch(K){T(K)}},I=M=>{try{C(l.throw(M))}catch(K){T(K)}},C=M=>M.done?s(M.value):Promise.resolve(M.value).then(b,I);C((l=l.apply(n,a)).next())});var Ue=ot((Fe,Te)=>{(function(n){"use strict";var a=n.setTimeout,l=n.clearTimeout,s=n.XMLHttpRequest,T=n.XDomainRequest,b=n.ActiveXObject,I=n.EventSource,C=n.document,M=n.Promise,K=n.fetch,fe=n.Response,L=n.TextDecoder,R=n.TextEncoder,G=n.AbortController;if(typeof window!="undefined"&&typeof C!="undefined"&&!("readyState"in C)&&C.body==null&&(C.readyState="loading",window.addEventListener("load",function(e){C.readyState="complete"},!1)),s==null&&b!=null&&(s=function(){return new b("Microsoft.XMLHTTP")}),Object.create==null&&(Object.create=function(e){function r(){}return r.prototype=e,new r}),Date.now||(Date.now=function(){return new Date().getTime()}),G==null){var D=K;K=function(e,r){var i=r.signal;return D(e,{headers:r.headers,credentials:r.credentials,cache:r.cache}).then(function(t){var c=t.body.getReader();return i._reader=c,i._aborted&&i._reader.cancel(),{status:t.status,statusText:t.statusText,headers:t.headers,body:{getReader:function(){return c}}}})},G=function(){this.signal={_reader:null,_aborted:!1},this.abort=function(){this.signal._reader!=null&&this.signal._reader.cancel(),this.signal._aborted=!0}}}function pe(){this.bitsNeeded=0,this.codePoint=0}pe.prototype.decode=function(e){function r(h,g,u){if(u===1)return h>=128>>g&&h<<g<=2047;if(u===2)return h>=2048>>g&&h<<g<=55295||h>=57344>>g&&h<<g<=65535;if(u===3)return h>=65536>>g&&h<<g<=1114111;throw new Error}function i(h,g){if(h===6*1)return g>>6>15?3:g>31?2:1;if(h===6*2)return g>15?3:2;if(h===6*3)return 3;throw new Error}for(var t=65533,c="",o=this.bitsNeeded,v=this.codePoint,y=0;y<e.length;y+=1){var p=e[y];o!==0&&(p<128||p>191||!r(v<<6|p&63,o-6,i(o,v)))&&(o=0,v=t,c+=String.fromCharCode(v)),o===0?(p>=0&&p<=127?(o=0,v=p):p>=192&&p<=223?(o=6*1,v=p&31):p>=224&&p<=239?(o=6*2,v=p&15):p>=240&&p<=247?(o=6*3,v=p&7):(o=0,v=t),o!==0&&!r(v,o,i(o,v))&&(o=0,v=t)):(o-=6,v=v<<6|p&63),o===0&&(v<=65535?c+=String.fromCharCode(v):(c+=String.fromCharCode(55296+(v-65535-1>>10)),c+=String.fromCharCode(56320+(v-65535-1&1023))))}return this.bitsNeeded=o,this.codePoint=v,c};var Oe=function(){try{return new L().decode(new R().encode("test"),{stream:!0})==="test"}catch(e){console.debug("TextDecoder does not support streaming option. Using polyfill instead: "+e)}return!1};(L==null||R==null||!Oe())&&(L=pe);var N=function(){};function k(e){this.withCredentials=!1,this.readyState=0,this.status=0,this.statusText="",this.responseText="",this.onprogress=N,this.onload=N,this.onerror=N,this.onreadystatechange=N,this._contentType="",this._xhr=e,this._sendTimeout=0,this._abort=N}k.prototype.open=function(e,r){this._abort(!0);var i=this,t=this._xhr,c=1,o=0;this._abort=function(u){i._sendTimeout!==0&&(l(i._sendTimeout),i._sendTimeout=0),(c===1||c===2||c===3)&&(c=4,t.onload=N,t.onerror=N,t.onabort=N,t.onprogress=N,t.onreadystatechange=N,t.abort(),o!==0&&(l(o),o=0),u||(i.readyState=4,i.onabort(null),i.onreadystatechange())),c=0};var v=function(){if(c===1){var u=0,E="",W=void 0;if("contentType"in t)u=200,E="OK",W=t.contentType;else try{u=t.status,E=t.statusText,W=t.getResponseHeader("Content-Type")}catch(le){u=0,E="",W=void 0}u!==0&&(c=2,i.readyState=2,i.status=u,i.statusText=E,i._contentType=W,i.onreadystatechange())}},y=function(){if(v(),c===2||c===3){c=3;var u="";try{u=t.responseText}catch(E){}i.readyState=3,i.responseText=u,i.onprogress()}},p=function(u,E){if((E==null||E.preventDefault==null)&&(E={preventDefault:N}),y(),c===1||c===2||c===3){if(c=4,o!==0&&(l(o),o=0),i.readyState=4,u==="load")i.onload(E);else if(u==="error")i.onerror(E);else if(u==="abort")i.onabort(E);else throw new TypeError;i.onreadystatechange()}},h=function(u){t!=null&&(t.readyState===4?(!("onload"in t)||!("onerror"in t)||!("onabort"in t))&&p(t.responseText===""?"error":"load",u):t.readyState===3?"onprogress"in t||y():t.readyState===2&&v())},g=function(){o=a(function(){g()},500),t.readyState===3&&y()};"onload"in t&&(t.onload=function(u){p("load",u)}),"onerror"in t&&(t.onerror=function(u){p("error",u)}),"onabort"in t&&(t.onabort=function(u){p("abort",u)}),"onprogress"in t&&(t.onprogress=y),"onreadystatechange"in t&&(t.onreadystatechange=function(u){h(u)}),("contentType"in t||!("ontimeout"in s.prototype))&&(r+=(r.indexOf("?")===-1?"?":"&")+"padding=true"),t.open(e,r,!0),"readyState"in t&&(o=a(function(){g()},0))},k.prototype.abort=function(){this._abort(!1)},k.prototype.getResponseHeader=function(e){return this._contentType},k.prototype.setRequestHeader=function(e,r){var i=this._xhr;"setRequestHeader"in i&&i.setRequestHeader(e,r)},k.prototype.getAllResponseHeaders=function(){return this._xhr.getAllResponseHeaders!=null&&this._xhr.getAllResponseHeaders()||""},k.prototype.send=function(){if((!("ontimeout"in s.prototype)||!("sendAsBinary"in s.prototype)&&!("mozAnon"in s.prototype))&&C!=null&&C.readyState!=null&&C.readyState!=="complete"){var e=this;e._sendTimeout=a(function(){e._sendTimeout=0,e.send()},4);return}var r=this._xhr;"withCredentials"in r&&(r.withCredentials=this.withCredentials);try{r.send(void 0)}catch(i){throw i}};function j(e){return e.replace(/[A-Z]/g,function(r){return String.fromCharCode(r.charCodeAt(0)+32)})}function ce(e){for(var r=Object.create(null),i=e.split(`\r
`),t=0;t<i.length;t+=1){var c=i[t],o=c.split(": "),v=o.shift(),y=o.join(": ");r[j(v)]=y}this._map=r}ce.prototype.get=function(e){return this._map[j(e)]},s!=null&&s.HEADERS_RECEIVED==null&&(s.HEADERS_RECEIVED=2);function ue(){}ue.prototype.open=function(e,r,i,t,c,o,v){e.open("GET",c);var y=0;e.onprogress=function(){var h=e.responseText,g=h.slice(y);y+=g.length,i(g)},e.onerror=function(h){h.preventDefault(),t(new Error("NetworkError"))},e.onload=function(){t(null)},e.onabort=function(){t(null)},e.onreadystatechange=function(){if(e.readyState===s.HEADERS_RECEIVED){var h=e.status,g=e.statusText,u=e.getResponseHeader("Content-Type"),E=e.getAllResponseHeaders();r(h,g,u,new ce(E))}},e.withCredentials=o;for(var p in v)Object.prototype.hasOwnProperty.call(v,p)&&e.setRequestHeader(p,v[p]);return e.send(),e};function he(e){this._headers=e}he.prototype.get=function(e){return this._headers.get(e)};function ge(){}ge.prototype.open=function(e,r,i,t,c,o,v){var y=null,p=new G,h=p.signal,g=new L;return K(c,{headers:v,credentials:o?"include":"same-origin",signal:h,cache:"no-store"}).then(function(u){return y=u.body.getReader(),r(u.status,u.statusText,u.headers.get("Content-Type"),new he(u.headers)),new M(function(E,W){var le=function(){y.read().then(function(U){if(U.done)E(void 0);else{var _=g.decode(U.value,{stream:!0});i(_),le()}}).catch(function(U){W(U)})};le()})}).catch(function(u){if(u.name!=="AbortError")return u}).then(function(u){t(u)}),{abort:function(){y!=null&&y.cancel(),p.abort()}}};function te(){this._listeners=Object.create(null)}function ye(e){a(function(){throw e},0)}te.prototype.dispatchEvent=function(e){e.target=this;var r=this._listeners[e.type];if(r!=null)for(var i=r.length,t=0;t<i;t+=1){var c=r[t];try{typeof c.handleEvent=="function"?c.handleEvent(e):c.call(this,e)}catch(o){ye(o)}}},te.prototype.addEventListener=function(e,r){e=String(e);var i=this._listeners,t=i[e];t==null&&(t=[],i[e]=t);for(var c=!1,o=0;o<t.length;o+=1)t[o]===r&&(c=!0);c||t.push(r)},te.prototype.removeEventListener=function(e,r){e=String(e);var i=this._listeners,t=i[e];if(t!=null){for(var c=[],o=0;o<t.length;o+=1)t[o]!==r&&c.push(t[o]);c.length===0?delete i[e]:i[e]=c}};function z(e){this.type=e,this.target=void 0}function d(e,r){z.call(this,e),this.data=r.data,this.lastEventId=r.lastEventId}d.prototype=Object.create(z.prototype);function f(e,r){z.call(this,e),this.status=r.status,this.statusText=r.statusText,this.headers=r.headers}f.prototype=Object.create(z.prototype);function m(e,r){z.call(this,e),this.error=r.error}m.prototype=Object.create(z.prototype);var H=-1,V=0,X=1,J=2,ae=-1,ee=0,Ae=1,Me=2,Ge=3,Xe=/^text\/event\-stream(;.*)?$/i,qe=1e3,Je=18e6,Ie=function(e,r){var i=e==null?r:parseInt(e,10);return i!==i&&(i=r),De(i)},De=function(e){return Math.min(Math.max(e,qe),Je)},ie=function(e,r,i){try{typeof r=="function"&&r.call(e,i)}catch(t){ye(t)}};function q(e,r){te.call(this),r=r||{},this.onopen=void 0,this.onmessage=void 0,this.onerror=void 0,this.url=void 0,this.readyState=void 0,this.withCredentials=void 0,this.headers=void 0,this._close=void 0,Ye(this,e,r)}function ze(){return s!=null&&"withCredentials"in s.prototype||T==null?new s:new T}var We=K!=null&&fe!=null&&"body"in fe.prototype;function Ye(e,r,i){r=String(r);var t=Boolean(i.withCredentials),c=i.lastEventIdQueryParameterName||"lastEventId",o=De(1e3),v=Ie(i.heartbeatTimeout,45e3),y="",p=o,h=!1,g=0,u=i.headers||{},E=i.Transport,W=We&&E==null?void 0:new k(E!=null?new E:ze()),le=E!=null&&typeof E!="string"?new E:W==null?new ge:new ue,U=void 0,_=0,$=H,oe="",Ee="",Y="",me="",x=ee,Ne=0,ne=0,Qe=function(S,w,B,P){if($===V)if(S===200&&B!=null&&Xe.test(B)){$=X,h=Date.now(),p=o,e.readyState=X;var F=new f("open",{status:S,statusText:w,headers:P});e.dispatchEvent(F),ie(e,e.onopen,F)}else{var O="";S!==200?(w&&(w=w.replace(/\s+/g," ")),O="EventSource's response has a status "+S+" "+w+" that is not 200. Aborting the connection."):O="EventSource's response has a Content-Type specifying an unsupported type: "+(B==null?"-":B.replace(/\s+/g," "))+". Aborting the connection.",_e();var F=new f("error",{status:S,statusText:w,headers:P});e.dispatchEvent(F),ie(e,e.onerror,F),console.error(O)}},Ze=function(S){if($===X){for(var w=-1,B=0;B<S.length;B+=1){var P=S.charCodeAt(B);(P===`
`.charCodeAt(0)||P==="\r".charCodeAt(0))&&(w=B)}var F=(w!==-1?me:"")+S.slice(0,w+1);me=(w===-1?me:"")+S.slice(w+1),S!==""&&(h=Date.now(),g+=S.length);for(var O=0;O<F.length;O+=1){var P=F.charCodeAt(O);if(x===ae&&P===`
`.charCodeAt(0))x=ee;else if(x===ae&&(x=ee),P==="\r".charCodeAt(0)||P===`
`.charCodeAt(0)){if(x!==ee){x===Ae&&(ne=O+1);var Q=F.slice(Ne,ne-1),Z=F.slice(ne+(ne<O&&F.charCodeAt(ne)===" ".charCodeAt(0)?1:0),O);Q==="data"?(oe+=`
`,oe+=Z):Q==="id"?Ee=Z:Q==="event"?Y=Z:Q==="retry"?(o=Ie(Z,o),p=o):Q==="heartbeatTimeout"&&(v=Ie(Z,v),_!==0&&(l(_),_=a(function(){ve()},v)))}if(x===ee){if(oe!==""){y=Ee,Y===""&&(Y="message");var se=new d(Y,{data:oe.slice(1),lastEventId:Ee});if(e.dispatchEvent(se),Y==="open"?ie(e,e.onopen,se):Y==="message"?ie(e,e.onmessage,se):Y==="error"&&ie(e,e.onerror,se),$===J)return}oe="",Y=""}x=P==="\r".charCodeAt(0)?ae:ee}else x===ee&&(Ne=O,x=Ae),x===Ae?P===":".charCodeAt(0)&&(ne=O+1,x=Me):x===Me&&(x=Ge)}}},He=function(S){if($===X||$===V)$=H,_!==0&&(l(_),_=0),_=a(function(){ve()},p),p=De(Math.min(o*16,p*2)),e.readyState=V;else if($===J&&S!=null){console.error(S);var w=new m("error",{error:S});e.dispatchEvent(w),ie(e,e.onerror,w)}},_e=function(){$=J,U!=null&&(U.abort(),U=void 0),_!==0&&(l(_),_=0),e.readyState=J},ve=function(){if(_=0,$!==H){if(!h&&U!=null)He(new Error("No activity within "+v+" milliseconds. "+($===V?"No response received.":g+" chars received.")+" Reconnecting.")),U!=null&&(U.abort(),U=void 0);else{var S=Math.max((h||Date.now())+v-Date.now(),1);h=!1,_=a(function(){ve()},S)}return}h=!1,g=0,_=a(function(){ve()},v),$=V,oe="",Y="",Ee=y,me="",Ne=0,ne=0,x=ee;var w=r;if(r.slice(0,5)!=="data:"&&r.slice(0,5)!=="blob:"&&y!==""){var B=r.indexOf("?");w=B===-1?r:r.slice(0,B+1)+r.slice(B+1).replace(/(?:^|&)([^=&]*)(?:=[^&]*)?/g,function(Z,se){return se===c?"":Z}),w+=(r.indexOf("?")===-1?"?":"&")+c+"="+encodeURIComponent(y)}var P=e.withCredentials,F={};F.Accept="text/event-stream";var O=e.headers;if(O!=null)for(var Q in O)Object.prototype.hasOwnProperty.call(O,Q)&&(F[Q]=O[Q]);try{U=le.open(W,Qe,Ze,He,w,P,F)}catch(Z){throw _e(),Z}};e.url=r,e.readyState=V,e.withCredentials=t,e.headers=u,e._close=_e,ve()}q.prototype=Object.create(te.prototype),q.prototype.CONNECTING=V,q.prototype.OPEN=X,q.prototype.CLOSED=J,q.prototype.close=function(){this._close()},q.CONNECTING=V,q.OPEN=X,q.CLOSED=J,q.prototype.withCredentials=void 0;var ke=I;s!=null&&(I==null||!("withCredentials"in I.prototype))&&(ke=q),function(e){if(typeof Te=="object"&&typeof Te.exports=="object"){var r=e(Fe);r!==void 0&&(Te.exports=r)}else typeof define=="function"&&define.amd?define(["exports"],e):e(n)}(function(e){e.EventSourcePolyfill=q,e.NativeEventSource=I,e.EventSource=ke})})(typeof globalThis=="undefined"?typeof window!="undefined"?window:typeof self!="undefined"?self:Fe:globalThis)});var lt={};st(lt,{Event:()=>A,initialize:()=>Ke});function xe(n){this.message=n}xe.prototype=new Error,xe.prototype.name="InvalidCharacterError";var Le=typeof window!="undefined"&&window.atob&&window.atob.bind(window)||function(n){var a=String(n).replace(/=+$/,"");if(a.length%4==1)throw new xe("'atob' failed: The string to be decoded is not correctly encoded.");for(var l,s,T=0,b=0,I="";s=a.charAt(b++);~s&&(l=T%4?64*l+s:s,T++%4)?I+=String.fromCharCode(255&l>>(-2*T&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return I};function ct(n){var a=n.replace(/-/g,"+").replace(/_/g,"/");switch(a.length%4){case 0:break;case 2:a+="==";break;case 3:a+="=";break;default:throw"Illegal base64url string!"}try{return function(l){return decodeURIComponent(Le(l).replace(/(.)/g,function(s,T){var b=T.charCodeAt(0).toString(16).toUpperCase();return b.length<2&&(b="0"+b),"%"+b}))}(a)}catch(l){return Le(a)}}function Se(n){this.message=n}function ut(n,a){if(typeof n!="string")throw new Se("Invalid token specified");var l=(a=a||{}).header===!0?0:1;try{return JSON.parse(ct(n.split(".")[l]))}catch(s){throw new Se("Invalid token specified: "+s.message)}}Se.prototype=new Error,Se.prototype.name="InvalidTokenError";var je=ut;function Ve(n){return{all:n=n||new Map,on:function(a,l){var s=n.get(a);s&&s.push(l)||n.set(a,[l])},off:function(a,l){var s=n.get(a);s&&s.splice(s.indexOf(l)>>>0,1)},emit:function(a,l){(n.get(a)||[]).slice().map(function(s){s(l)}),(n.get("*")||[]).slice().map(function(s){s(a,l)})}}}var Pe=ft(Ue());var A;(function(n){n.READY="ready",n.CONNECTED="connected",n.DISCONNECTED="disconnected",n.CHANGED="changed",n.ERROR="error"})(A||(A={}));var Be={debug:!1,baseUrl:"https://config.ff.harness.io/api/1.0",eventUrl:"https://events.ff.harness.io/api/1.0",streamEnabled:!0,allAttributesPrivate:!1,privateAttributeNames:[]},de=(n,...a)=>console.error(`[FF-SDK] ${n}`,...a),Ce=30*1e3;var vt="1.5.0",pt=500,Re=globalThis.fetch,ht=Pe.EventSourcePolyfill,$e=n=>{let{value:a}=n;try{switch(n.kind.toLowerCase()){case"int":case"number":a=Number(a);break;case"boolean":a=a.toString().toLowerCase()==="true";break;case"json":a=JSON.parse(a);break}}catch(l){de(l)}return a},Ke=(n,a,l)=>{let s,T,b,I,C,M=!0,K=()=>{M=!1},fe=()=>{M=!0},L=[],R=Ve(),G=re(re({},Be),l),D=(d,...f)=>{G.debug&&console.debug(`[FF-SDK] ${d}`,...f)},pe=d=>{if(M){let f=Date.now();f-d.lastAccessed>pt&&(d.count++,d.lastAccessed=f)}};globalThis.onbeforeunload=()=>{L.length&&globalThis.localStorage&&(K(),globalThis.localStorage.HARNESS_FF_METRICS=JSON.stringify(L),fe())};let Oe=(d,f)=>be(void 0,null,function*(){return(yield(yield Re(`${f.baseUrl}/client/auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:d,target:a})})).json()).authToken}),N=()=>{if(L.length){D("Sending metrics...",{metrics:L,evaluations:k});let d={metricsData:L.map(f=>({timestamp:Date.now(),count:f.count,metricsType:"FFMETRICS",attributes:[{key:"featureIdentifier",value:f.featureIdentifier},{key:"featureName",value:f.featureIdentifier},{key:"variationIdentifier",value:f.variationIdentifier},{key:"target",value:a.identifier},{key:"SDK_NAME",value:"JavaScript"},{key:"SDK_LANGUAGE",value:"JavaScript"},{key:"SDK_TYPE",value:"client"},{key:"SDK_VERSION",value:vt}]}))};Re(`${G.eventUrl}/metrics/${s}?cluster=${T}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I}`},body:JSON.stringify(d)}).then(()=>{L=[]}).catch(f=>{D(f)}).finally(()=>{C=window.setTimeout(N,Ce)})}else C=window.setTimeout(N,Ce)},k={},j={};Oe(n,G).then(d=>{I=d;let f=je(d);if(D("Authenticated",f),globalThis.localStorage&&globalThis.localStorage.HARNESS_FF_METRICS)try{delete globalThis.localStorage.HARNESS_FF_METRICS,D("Picking up metrics from previous session")}catch(m){}C=window.setTimeout(N,Ce),s=f.environment,T=f.clusterIdentifier,ce().then(()=>{D("Fetch all flags ok",j)}).then(()=>{he()}).then(()=>{D("Event stream ready",{storage:j}),R.emit(A.READY,Object.keys(j))}).catch(m=>{R.emit(A.ERROR,m)})}).catch(d=>{de("Authentication error: ",d),R.emit(A.ERROR,d)});let ce=()=>be(void 0,null,function*(){try{(yield(yield Re(`${G.baseUrl}/client/env/${s}/target/${a.identifier}/evaluations?cluster=${T}`,{headers:{Authorization:`Bearer ${I}`}})).json()).forEach(m=>{let H=$e(m),V=j[m.flag];H!==V&&(D("Flag variation has changed for ",m.identifier),j[m.flag]=H,k[m.flag]=re(re({},m),{value:H}))})}catch(d){return de("Features fetch operation error: ",d),R.emit(A.ERROR,d),d}}),ue=d=>be(void 0,null,function*(){try{let f=yield Re(`${G.baseUrl}/client/env/${s}/target/${a.identifier}/evaluations/${d}?cluster=${T}`,{headers:{Authorization:`Bearer ${I}`}});if(f.ok){let m=yield f.json(),H=$e(m);K(),j[d]=H,k[d]=re(re({},m),{value:H}),fe(),R.emit(A.CHANGED,d)}else R.emit(A.ERROR,f)}catch(f){de("Feature fetch operation error: ",f),R.emit(A.ERROR,f)}}),he=()=>{if(!G.streamEnabled){D("Stream is disabled by configuration. Note: Polling is not yet supported");return}b=new ht(`${G.baseUrl}/stream?cluster=${T}`,{headers:{Authorization:`Bearer ${I}`,"API-Key":n}}),b.onopen=d=>{D("Stream connected",d),R.emit(A.CONNECTED)},b.onclose=d=>{D("Stream disconnected"),R.emit(A.DISCONNECTED)},b.onerror=d=>{de("Stream has issue",d),R.emit(A.ERROR,d)},b.addEventListener("*",d=>{let f=JSON.parse(d.data);switch(D("Received event from stream: ",f),f.event){case"create":setTimeout(()=>ue(f.identifier),1e3);break;case"patch":f.domain==="target-segment"?ce():ue(f.identifier);break;case"delete":delete j[f.identifier],R.emit(A.CHANGED,{flag:f.identifier,value:void 0,deleted:!0}),D("Evaluation deleted",{message:f,storage:j});break}})},ge=(d,f)=>R.on(d,f),te=(d,f)=>{d?R.off(d,f):z()},ye=(d,f)=>{var H;let m=j[d];if(m!==void 0){let V=m,X=d,J=L.find(ae=>ae.featureIdentifier===X&&ae.featureValue===V);J?(pe(J),J.variationIdentifier=((H=k[X])==null?void 0:H.identifier)||""):L.push({featureIdentifier:X,featureValue:V,count:M?1:0,variationIdentifier:k[X].identifier||"",lastAccessed:Date.now()})}return m!==void 0?m:f},z=()=>{D("Closing event stream"),j={},k={},clearTimeout(C),R.all.clear(),b.close()};return{on:ge,off:te,variation:ye,close:z}};return lt;})();
/** @license
 * eventsource.js
 * Available under MIT License (MIT)
 * https://github.com/Yaffle/EventSource/
 */
//# sourceMappingURL=sdk.client-iife.js.map
